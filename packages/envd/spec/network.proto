syntax = "proto3";

import "spec/permissions.proto";
import "google/protobuf/empty.proto";

option go_package = "github.com/e2b-dev/infra/packages/envd/spec";

package network;

service Network {
    rpc ConfigurePort(ConfigurePortRequest) returns (google.protobuf.Empty);
    rpc ListPorts(ListPortsRequest) returns (ListPortsResponse);
    rpc WatchPorts(WatchPortsRequest) returns (stream Port);
}

message ConfigurePortRequest {
    Port port = 1;

    permissions.AccessControl access = 2;
}

message ListPortsRequest {
    permissions.AccessControl access = 1;
}

message ListPortsResponse {
    repeated Port ports = 1;
}

message WatchPortsRequest {
    repeated uint32 ports = 1;

    permissions.AccessControl access = 2;
}


message Port {
    uint32 port = 1;
    State state = 2;

    enum State {
        UNKNOWN_PortState = 0;
        OPEN = 1;
        CLOSE = 2;
    }
}
